## [ä»é›¶å¼€å§‹ç¼–å†™Xposedæ¨¡å—](https://lbqaq.top/p/init-xposed/)

### è®°å½•ç¬¬ä¸€æ¬¡ç¼–å†™Xposedæ¨¡å—çš„æ­¥éª¤

2023-07-21

é˜…è¯»æ—¶é•¿: 13 åˆ†é’Ÿ

ä¹‹å‰å†™è¿‡ä¸€ç¯‡å…³äº[Magiskæ¨¡å—](https://lbqaq.top/p/%E7%AE%80%E6%98%93magisk%E6%A8%A1%E5%9D%97%E7%9A%84%E5%88%B6%E4%BD%9C/)çš„ç¼–å†™çš„æ–‡ç« ï¼Œä¸è¿‡Magiskä¿®æ”¹çš„éƒ½æ˜¯æ¯”è¾ƒåç³»ç»Ÿçš„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ç”¨çš„å¹¶ä¸æ˜¯å¾ˆå¤šã€‚äºæ˜¯æˆ‘ä¾¿æŠŠç›®å…‰è½¬å‘Xposedï¼Œæ¯•ç«Ÿä¼šHookçœŸçš„å¤ªé…·è¾£ğŸ˜

## [#](https://lbqaq.top/p/init-xposed/#xposed%e7%9a%84%e5%9f%ba%e6%9c%ac%e6%a6%82%e5%bf%b5) Xposedçš„åŸºæœ¬æ¦‚å¿µ

æåˆ°Xposedï¼Œçˆ±ç©æœºçš„ç”¨æˆ·éƒ½åº”è¯¥å¬è¿‡ä»–çš„å¤§åï¼Œä½œä¸ºä¸€æ¬¾å¯ä»¥åœ¨ä¸ä¿®æ”¹APKçš„æƒ…å†µä¸‹å½±å“ç¨‹åºè¿è¡Œçš„æ¡†æ¶ï¼Œå¯ä»¥åŸºäºå®ƒå¯ä»¥åˆ¶ä½œå‡ºè®¸å¤šåŠŸèƒ½å¼ºå¤§çš„æ¨¡å—ï¼Œä¸”åœ¨åŠŸèƒ½ä¸å†²çªçš„æƒ…å†µä¸‹åŒæ—¶è¿ä½œã€‚å¾®ä¿¡é˜²æ’¤å›ã€æ­¥æ•°ä¿®æ”¹ã€å»å¹¿å‘Šã€ç¾åŒ–â€¦â€¦.ä»–èƒ½å®ç°è®¸è®¸å¤šå¤šçš„åŠŸèƒ½ï¼Œå¯ä»¥è¯´æ²¡æœ‰å®ƒç©æœºçš„ä¸–ç•Œå°†ä¼šå°‘å¾ˆå¤šçš„ä¹è¶£ã€‚

å®ƒçš„åŸç†å°±æ˜¯é€šè¿‡æ›¿æ¢ç³»ç»ŸåŸæœ¬çš„`app_process`ï¼ŒåŠ è½½ä¸€ä¸ªé¢å¤–çš„jaråŒ…ï¼Œä»è€Œå®ç°å¯¹zygoteè¿›ç¨‹åŠå…¶åˆ›å»ºçš„Dalvik/ARTè™šæ‹Ÿæœºçš„åŠ«æŒã€‚

æ²¡å¬æ‡‚ï¼Ÿæ²¡å…³ç³»ï¼Œ~æˆ‘ä¹Ÿä¸æ‡‚~ã€‚ç›®å‰æˆ‘ä»¬åªè¦å…³æ³¨å¦‚ä½•ä½¿ç”¨å³å¯äº†ï¼Œè‡³äºåŸç†å¯ä»¥å…ˆæ”¾ä¸€æ”¾ã€‚

## [#](https://lbqaq.top/p/init-xposed/#%e7%8e%af%e5%a2%83%e5%87%86%e5%a4%87) ç¯å¢ƒå‡†å¤‡

åœ¨å¼€å§‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ï¼š

* ä¸€å°å¯ä»¥å®‰è£…Xposedæ¡†æ¶çš„æ‰‹æœºï¼ˆæ¨èLSPosedã€Android 10+ï¼‰
* ä¸€å°å¯ä»¥ç¼–å†™ä»£ç å¹¶ä¸”è£…æœ‰jdkçš„ç”µè„‘
* ä¸€ä¸ªåå«[Android Studio](https://developer.android.com/studio)çš„è½¯ä»¶ï¼ˆæˆ‘ä¸»æ‰“ä¸€ä¸ªå›é€†ï¼Œç”¨[IDEA](https://www.jetbrains.com/zh-cn/idea/download/)åŒæ ·å¯ä»¥ï¼‰
* ä¸€ä¸ªåç¼–è¯‘è½¯ä»¶ï¼Œå¦‚ï¼š[JADX](https://github.com/skylot/jadx)
* ä¸€ä¸ªå¯ä»¥æŸ¥çœ‹å¸ƒå±€çš„Appï¼Œå¦‚ï¼šå¼€å‘è€…åŠ©æ‰‹

è¿™æ¬¡æˆ‘æ‰“ç®—ä»ä¸€ä¸ªå®ä¾‹å‡ºå‘ï¼šå°æ˜æ‰‹æœºä¸Šè£…äº†ä¸€äº›æ¶æ„è½¯ä»¶ï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡Xposedè¿›è¡ŒHookï¼Œä¸è®©å°æ˜å¯åŠ¨è¿™äº›è½¯ä»¶ã€‚

## [#](https://lbqaq.top/p/init-xposed/#%e5%87%86%e5%a4%87%e5%b7%a5%e4%bd%9c) å‡†å¤‡å·¥ä½œ

### [#](https://lbqaq.top/p/init-xposed/#%e5%88%9b%e5%bb%ba%e9%a1%b9%e7%9b%ae%e5%bc%95%e5%85%a5%e4%be%9d%e8%b5%96) åˆ›å»ºé¡¹ç›®&å¼•å…¥ä¾èµ–

é¦–å…ˆåœ¨IDEAé€‰æ‹©æ–°å»ºé¡¹ç›®ï¼Œå¯ä»¥çœ‹åˆ°ç”Ÿæˆå™¨ä¸‹æœ‰Androidè¿™é¡¹ï¼Œæˆ‘ä»¬é€‰æ‹©å®ƒã€‚

ç¬¬ä¸€æ¬¡é€‰æ‹©æ—¶å¯èƒ½ä¼šè¦æ±‚ä½ ä¸‹è½½å®‰å“çš„SDKï¼ŒæŒ‰ç…§æŒ‡ç¤ºä¸€æ­¥ä¸€æ­¥è¿›è¡Œå°±å¥½ã€‚

#### [#](https://lbqaq.top/p/init-xposed/#java) Java

æˆ‘ä»¬é€‰æ‹©åˆ›å»ºä¸€ä¸ª`No Activity`ï¼Œè¯­è¨€é€‰æ‹©`Java`ï¼ŒSDKé€‰é»˜è®¤çš„`API 24`å°±å¯ã€‚

ç„¶åï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥Xposedçš„åº“ï¼Œä¸è¿‡å®ƒå¹¶æ²¡æœ‰ä¸Šä¼ åˆ°MavenCentralä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨`settings.gradle`é‡Œä¿®æ”¹ä¸€ä¸‹(gradle 7.0+)

æ‰“å¼€`settings.gradle`ï¼Œæ·»åŠ ä¸€è¡Œä»£ç 

```gradle
dependencyResolutionManagement {
    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
    repositories {
        google()
        mavenCentral()
        maven { url 'https://api.xposed.info/' }  // æ·»åŠ è¿™ä¸€è¡Œå³å¯
    }
}
```

ä¹‹åï¼Œè¿›å…¥æˆ‘ä»¬appç›®å½•ä¸‹çš„build.gradleï¼Œå¼•å…¥xposedçš„ä¾èµ–


```gradle
dependencies {
    compileOnly 'de.robv.android.xposed:api:82' //æ·»åŠ æˆ‘
    // compileOnly 'de.robv.android.xposed:api:82:sources' // ä¸è¦å¯¼å…¥æºç ï¼Œè¿™ä¼šå¯¼è‡´ideaæ— æ³•ç´¢å¼•æ–‡ä»¶ï¼Œä»è€Œè®©è¯­æ³•æç¤ºå¤±æ•ˆ
}
```


|  |  |
| - | - |

æˆ‘ä»¬è¿˜è¦åœ¨`./app/src/main/res/values`ç›®å½•ä¸‹åˆ›å»º`arrays.xml`ï¼Œå¡«å…¥ä¸‹é¢çš„å†…å®¹ï¼š


```xml
<resources>
    <string-array name="xposedscope" >
        <!-- è¿™é‡Œå¡«å†™æ¨¡å—çš„ä½œç”¨åŸŸåº”ç”¨çš„åŒ…åï¼Œå¯ä»¥å¡«å¤šä¸ªã€‚ -->
        <item>ceui.lisa.pixiv</item>
        <item>com.xjs.ehviewer</item>
        <item>com.picacomic.fregata</item>
    </string-array>
</resources>
```


|  |  |
| - | - |

è¿™ä¸€æ­¥ä¸»è¦æ˜¯æŒ‡å®šæ¨¡å—çš„ä½œç”¨åŸŸåŒ…åï¼Œæ•ˆæœå°±æ˜¯åœ¨Lsposedä¸­å‹¾é€‰ä½œç”¨åŸŸæ—¶ä¼šåœ¨åº”ç”¨ä¸‹æç¤ºæ¨èåº”ç”¨ã€‚

[![æ¨èåº”ç”¨æ•ˆæœ](https://lbqaq.top/p/init-xposed/IMAGE/1.jpg)](https://lbqaq.top/p/init-xposed/IMAGE/1.jpg)
æ¨èåº”ç”¨æ•ˆæœ

æœ€åï¼Œæˆ‘ä»¬åœ¨Runé‚£é‡Œç¼–è¾‘ä¸€ä¸‹å¯åŠ¨é…ç½®ï¼Œå‹¾é€‰`Always install with package manager`å¹¶ä¸”å°†`Launch Options`æ”¹æˆ`Nothing`

#### [#](https://lbqaq.top/p/init-xposed/#kotlin) Kotlin

åˆ›å»ºé¡¹ç›®çš„éƒ¨åˆ†å’ŒJavaçš„è®¾ç½®æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œåªä¸è¿‡æ˜¯éœ€è¦å°†è¯­è¨€åˆ‡æ¢ä¸€ä¸‹ã€‚æ–°ç‰ˆæœ¬çš„Android Studioå°†åŸæ¥çš„æ‰“åŒ…è¯­è¨€æ¢æˆäº†Kotlinï¼Œæ‰€ä»¥æˆ‘ä»¬çš„è®¾ç½®æœ‰ä¸€äº›ä¸ä¸€æ ·çš„åœ°æ–¹ã€‚[2024.09.15æ›´æ–°](https://lbqaq.top/p/init-xposed/#20240915)

åŸæ¥çš„`settings.gradle`å˜ä¸º`settings.gradle.kts`


```gradle
dependencyResolutionManagement {
    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
    repositories {
        google()
        mavenCentral()
        maven { url =  uri("https://api.xposed.info/") } //æ·»åŠ è¿™ä¸€è¡Œ
    }
}
```



åŸæ¥çš„`build.gradle`å˜ä¸º`build.gradle.kts`

```gradle
dependencies {
    compileOnly("de.robv.android.xposed:api:82") //æ·»åŠ æˆ‘
}
```



### [#](https://lbqaq.top/p/init-xposed/#%e5%a3%b0%e6%98%8e%e6%a8%a1%e5%9d%97) å£°æ˜æ¨¡å—

æ¥ä¸‹æ¥å°±æ˜¯è¦å£°æ˜æˆ‘ä»¬æ˜¯ä¸€ä¸ªXposedæ¨¡å—ï¼Œæ–¹ä¾¿æ¡†æ¶å‘ç°ã€‚

åœ¨`./app/src/main/AndroidManifest.xml`é‡Œï¼Œæˆ‘ä»¬å°†`<application ... />`æ”¹æˆä»¥ä¸‹å½¢å¼ï¼ˆæ³¨æ„ï¼Œæ˜¯æ”¹æˆï¼å°±æ˜¯æŠŠç»“å°¾çš„`/>`æ¢æˆ`> </application>`ï¼‰


```xml
<application ... > 
		<!-- æ˜¯å¦æ˜¯xposedæ¨¡å—ï¼Œxposedæ ¹æ®è¿™ä¸ªæ¥åˆ¤æ–­æ˜¯å¦æ˜¯æ¨¡å— -->
        <meta-data
                android:name="xposedmodule"
                android:value="true" />
        <!-- æ¨¡å—æè¿°ï¼Œæ˜¾ç¤ºåœ¨xposedæ¨¡å—åˆ—è¡¨é‚£é‡Œç¬¬äºŒè¡Œ -->
        <meta-data
                android:name="xposeddescription"
                android:value="ä¸å¯ä»¥æ¶©æ¶©" />
        <!-- æœ€ä½xposedç‰ˆæœ¬å·(libæ–‡ä»¶åå¯çŸ¥,ä¸€èˆ¬å¡«54å³å¯) -->
        <meta-data
                android:name="xposedminversion"
                android:value="54" />
        <!-- æ¨¡å—ä½œç”¨åŸŸ -->
        <meta-data
                android:name="xposedscope"
                android:resource="@array/xposedscope"/>
    </application>
```



ç„¶ååœ¨`src/main`ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹åå«`assets`ï¼Œå¹¶ä¸”åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å«`xposed_init`ï¼Œ**æ³¨æ„ï¼Œå®ƒæ²¡æœ‰åç¼€åï¼ï¼**ã€‚

æ¥ç€æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ªå…¥å£ç±»ï¼Œåå«`MainHook`ï¼ˆæˆ–è€…éšä¾¿ä½ æƒ³å–ä»€ä¹ˆåå­—éƒ½è¡Œï¼‰ï¼Œåˆ›å»ºå¥½åå›åˆ°æˆ‘ä»¬çš„`xposed_init`é‡Œå¹¶ç”¨æ–‡æœ¬æ–‡ä»¶çš„æ–¹å¼æ‰“å¼€å®ƒï¼Œè¾“å…¥æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„ç±»çš„å®Œæ•´è·¯å¾„ã€‚å¦‚ï¼š`top.lbqaq.nosese.MainHook`ï¼ŒåŒæ—¶**æ³¨æ„å¤§å°å†™**ã€‚

å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ­£å¼å¼€å§‹ç¼–å†™Xposedæ¨¡å—äº†ã€‚

## [#](https://lbqaq.top/p/init-xposed/#%e6%a8%a1%e5%9d%97%e7%bc%96%e5%86%99) æ¨¡å—ç¼–å†™

### [#](https://lbqaq.top/p/init-xposed/#mainhook) MainHook

åœ¨`MainHook`é‡Œï¼Œæˆ‘ä»¬éœ€è¦å®ç°Xposedçš„IXposedHookLoadPackageæ¥å£ï¼Œä»¥ä¾¿æ‰§è¡ŒHookæ“ä½œã€‚å°†ä»¥ä¸‹å†…å®¹æ›¿æ¢åŸæ¥çš„ç±»

```java
import de.robv.android.xposed.IXposedHookLoadPackage;
import de.robv.android.xposed.callbacks.XC_LoadPackage;

public class MainHook implements IXposedHookLoadPackage {
    @Override
    public void handleLoadPackage(XC_LoadPackage.LoadPackageParam lpparam) throws Throwable {
        // è¿‡æ»¤ä¸å¿…è¦çš„åº”ç”¨
        if (!lpparam.packageName.equals("ceui.lisa.pixiv")) return;
        // æ‰§è¡ŒHook
        hook(lpparam);
    }

    private void hook(XC_LoadPackage.LoadPackageParam lpparam) {
        // å…·ä½“æµç¨‹
    }
}
```



å¯¹äºKotlinï¼Œä»£ç å¦‚ä¸‹ï¼š


```kotlin
import de.robv.android.xposed.IXposedHookLoadPackage
import de.robv.android.xposed.callbacks.XC_LoadPackage

class MainHook : IXposedHookLoadPackage {
    override fun handleLoadPackage(lpparam: XC_LoadPackage.LoadPackageParam) {
        // è¿‡æ»¤ä¸å¿…è¦çš„åº”ç”¨
        if (lpparam.packageName != "ceui.lisa.pixiv") return
        // æ‰§è¡ŒHook
        hook(lpparam)
    }

    private fun hook(lpparam: XC_LoadPackage.LoadPackageParam) {
        // å…·ä½“æµç¨‹
    }
}
```



åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬çš„å‡†å¤‡å·¥ä½œå·²ç»å®Œæˆï¼Œå®‰è£…æ¨¡å—å¹¶åœ¨æ¡†æ¶ä¸­æ¿€æ´»å®ƒï¼

### [#](https://lbqaq.top/p/init-xposed/#%e9%98%bb%e6%ad%a2%e5%ba%94%e7%94%a8%e5%90%af%e5%8a%a8) é˜»æ­¢åº”ç”¨å¯åŠ¨

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦åç¼–è¯‘ç¨‹åºæ¥æ‰¾åˆ°éœ€è¦Hookçš„ç‚¹ã€‚æ ¹æ®å®ä¾‹çš„è¦æ±‚ï¼Œæˆ‘ä»¬éœ€è¦é˜»æ­¢å°æ˜å¯åŠ¨æŸäº›åº”ç”¨ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬åªéœ€è¦Hookå¯åŠ¨å‡½æ•°ï¼Œè®©å…¶æ— æ³•è¿è¡Œå³å¯ã€‚

åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬è¦å…ˆäº†è§£Androidçš„å››å¤§ç»„ä»¶ä¹‹ä¸€â€”â€”â€œActivity(æ´»åŠ¨)â€

> åœ¨åº”ç”¨ä¸­çš„ä¸€ä¸ªActivityå¯ä»¥ç”¨æ¥è¡¨ç¤ºä¸€ä¸ªç•Œé¢ï¼Œæ„æ€å¯ä»¥ç†è§£ä¸ºâ€œæ´»åŠ¨â€ï¼Œå³ä¸€ä¸ªæ´»åŠ¨å¼€å§‹ï¼Œä»£è¡¨ Activityç»„ä»¶å¯åŠ¨ï¼Œæ´»åŠ¨ç»“æŸï¼Œä»£è¡¨ä¸€ä¸ªActivityçš„ç”Ÿå‘½å‘¨æœŸç»“æŸã€‚ä¸€ä¸ªAndroidåº”ç”¨å¿…é¡»é€šè¿‡Activityæ¥è¿è¡Œå’Œå¯åŠ¨ï¼ŒActivityçš„ç”Ÿå‘½å‘¨æœŸäº¤ç»™ç³»ç»Ÿç»Ÿä¸€ç®¡ç†ã€‚


| å‡½æ•°åç§°    | æè¿°                                                                                                                               |
| ----------- | ---------------------------------------------------------------------------------------------------------------------------------- |
| onCreate()  | ä¸€ä¸ªActivityå¯åŠ¨åç¬¬ä¸€ä¸ªè¢«è°ƒç”¨çš„å‡½æ•°ï¼Œå¸¸ç”¨æ¥åœ¨æ­¤æ–¹æ³•ä¸­è¿›è¡ŒActivityçš„ä¸€äº›åˆå§‹åŒ–æ“ä½œã€‚ä¾‹å¦‚åˆ›å»ºViewï¼Œç»‘å®šæ•°æ®ï¼Œæ³¨å†Œç›‘å¬ï¼ŒåŠ è½½å‚æ•°ç­‰ã€‚ |
| onStart()   | å½“Activityæ˜¾ç¤ºåœ¨å±å¹•ä¸Šæ—¶ï¼Œæ­¤æ–¹æ³•è¢«è°ƒç”¨ä½†æ­¤æ—¶è¿˜æ— æ³•è¿›è¡Œä¸ç”¨æˆ·çš„äº¤äº’æ“ä½œã€‚                                                           |
| onResume()  | è¿™ä¸ªæ–¹æ³•åœ¨onStart()ä¹‹åè°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯åœ¨Activityå‡†å¤‡å¥½ä¸ç”¨æˆ·è¿›è¡Œäº¤äº’çš„æ—¶å€™è°ƒç”¨ï¼Œæ­¤æ—¶çš„Activityä¸€å®šä½äºActivityæ ˆé¡¶ï¼Œå¤„äºè¿è¡ŒçŠ¶æ€ã€‚    |
| onPause()   | è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨ç³»ç»Ÿå‡†å¤‡å»å¯åŠ¨æˆ–è€…æ¢å¤å¦å¤–ä¸€ä¸ªActivityçš„æ—¶å€™è°ƒç”¨ï¼Œé€šå¸¸åœ¨è¿™ä¸ªæ–¹æ³•ä¸­æ‰§è¡Œä¸€äº›é‡Šæ”¾èµ„æºçš„æ–¹æ³•ï¼Œä»¥åŠä¿å­˜ä¸€äº›å…³é”®æ•°æ®ã€‚       |
| onStop()    | è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨Activityå®Œå…¨ä¸å¯è§çš„æ—¶å€™è°ƒç”¨çš„ã€‚                                                                                       |
| onDestroy() | è¿™ä¸ªæ–¹æ³•åœ¨Activityé”€æ¯ä¹‹å‰è°ƒç”¨ï¼Œä¹‹åActivityçš„çŠ¶æ€ä¸ºé”€æ¯çŠ¶æ€ã€‚                                                                     |
| onRestart() | å½“Activityä»åœæ­¢stopçŠ¶æ€æ¢è¿›å…¥startçŠ¶æ€æ—¶è°ƒç”¨çŠ¶æ€ã€‚                                                                                |

å½“ Activity è¿›å…¥æ–°çŠ¶æ€æ—¶ï¼Œç³»ç»Ÿä¼šè°ƒç”¨å…¶ä¸­æ¯ä¸ªå›è°ƒã€‚

[![Activityç”Ÿå‘½å‘¨æœŸ](https://lbqaq.top/p/init-xposed/IMAGE/activity_lifecycle.png)](https://lbqaq.top/p/init-xposed/IMAGE/activity_lifecycle.png)
Activityç”Ÿå‘½å‘¨æœŸ

é‚£ä¹ˆï¼Œæˆ‘ä»¬çš„æ€è·¯å°±å¾ˆæ˜ç¡®äº†ï¼šåªè¦æ‰¾åˆ°è¿™äº›ç¨‹åºçš„èµ·å§‹Activityï¼Œå¹¶Hookå®ƒçš„`onCreate()`å‡½æ•°ï¼Œåœ¨å…¶å¯åŠ¨æ—¶å°±å°†å…¶æ€æ­»ï¼Œè¿™æ ·èƒ½å®ç°æ— æ³•å¯åŠ¨è¯¥ç¨‹åºã€‚

æˆ‘ä»¬ä½¿ç”¨å¼€å‘è€…åŠ©æ‰‹ï¼Œé€‰æ‹©å¸ƒå±€æŸ¥çœ‹ï¼Œç„¶åæ‰“å¼€ç›®æ ‡åº”ç”¨ã€‚å¯ä»¥çœ‹åˆ°ï¼Œå®ƒæ˜¾ç¤ºäº†å½“å‰çš„åŒ…åå’Œå½“å‰Activityã€‚

[![å¸ƒå±€æŸ¥çœ‹](https://lbqaq.top/p/init-xposed/IMAGE/2.jpg)](https://lbqaq.top/p/init-xposed/IMAGE/2.jpg)
å¸ƒå±€æŸ¥çœ‹

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ä½¿ç”¨jadx-guiï¼Œåç¼–è¯‘è¯¥åº”ç”¨ï¼Œæ‰¾åˆ°è¯¥Activity(`ceui.lisa.activities.MainActivity`)ï¼Œå¹¶å¯»æ‰¾æ˜¯å¦æœ‰`onCreate()`å‡½æ•°ï¼Œå¦‚æœå­˜åœ¨ç›´æ¥Hookå³å¯ã€‚

[![jadx-guiåç¼–è¯‘](https://lbqaq.top/p/init-xposed/IMAGE/image-20230721100655336.png)](https://lbqaq.top/p/init-xposed/IMAGE/image-20230721100655336.png)
jadx-guiåç¼–è¯‘

ç„¶è€Œï¼Œè¿™ä¸ªç¨‹åºå±…ç„¶æ²¡æœ‰ğŸ˜¥ï¼Œè¯´æ˜å®ƒæ²¡æœ‰é‡å†™è¯¥æ–¹æ³•ï¼Œé‚£è¯¥å¦‚ä½•åšå‘¢ï¼Ÿè¿™æ—¶å°±å¯ä»¥ç”¨ç¬¬äºŒç§æ–¹æ³•äº†ã€‚

### [#](https://lbqaq.top/p/init-xposed/#%e9%81%8d%e5%8e%86%e6%89%80%e6%9c%89%e7%b1%bb%e4%b8%8b%e7%9a%84%e6%89%80%e6%9c%89%e6%96%b9%e6%b3%95) éå†æ‰€æœ‰ç±»ä¸‹çš„æ‰€æœ‰æ–¹æ³•

ä»æ ‡é¢˜å°±èƒ½çœ‹å‡ºæ¥ï¼Œæˆ‘ç›´æ¥æŠŠä½ æ‰€æœ‰èƒ½Hookçš„æ–¹æ³•å…¨éƒ¨è¯»å‡ºæ¥ï¼Œé‚£ä¸å°±éšä¾¿æˆ‘æŒ‘äº†å˜›ã€‚

æˆ‘ä»¬çŸ¥é“ï¼ŒJavaç¨‹åºéƒ½è¿è¡Œåœ¨jvmè™šæ‹Ÿæœºä¸­ï¼Œjvmè™šæ‹Ÿæœºé€šè¿‡ClassLoaderåŠ¨æ€è£…è½½æ‰€éœ€çš„classã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬ç›´æ¥Hook ClassLoader ï¼Œä¸å°±çŸ¥é“ä½ æœ‰å“ªäº›æ–¹æ³•è¢«åŠ è½½è¿›æ¥äº†ã€‚


```java
public void hook(XC_LoadPackage.LoadPackageParam lpparam) {
    XposedHelpers.findAndHookMethod(ClassLoader.class, "loadClass", String.class, new XC_MethodHook() {
        @Override
        protected void afterHookedMethod(MethodHookParam param) throws Throwable {
            super.afterHookedMethod(param);
            Class clazz = (Class) param.getResult();
            String clazzName = clazz.getName();
            //æ’é™¤éåŒ…åçš„ç±»
            if(clazzName.contains("ceui.lisa")){
                Method[] mds = clazz.getDeclaredMethods();
                for(int i =0;i<mds.length;i++){
                    final Method md = mds[i];
                    int mod = mds[i].getModifiers();
                    //å»é™¤æŠ½è±¡ã€nativeã€æ¥å£æ–¹æ³•
                    if(!Modifier.isAbstract(mod)
                            && !Modifier.isNative(mod)
                            &&!Modifier.isAbstract(mod)){
                        XposedBridge.hookMethod(mds[i], new XC_MethodHook() {
                            @Override
                            protected void beforeHookedMethod(MethodHookParam param) throws Throwable {
                                super.beforeHookedMethod(param);
                                Log.d("lbqaq",md.toString());
                            }
                        });
                    }
                }
            }
        }
    });
}
```


|  |  |
| - | - |

ï¼ˆPSï¼šè¿™ä¸ªç¨‹åºå¾ˆå¥‡æ€ªï¼ŒåŒ…åæœ‰pixivï¼Œä½†ç±»åæ²¡æœ‰ï¼Œæ‰€ä»¥ç”¨`ceui.lisa.pixiv`ä¼šæŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼‰

å°†ä¸Šé¢è¿™æ®µä»£ç å¤åˆ¶åˆ°ä¹‹å‰å†™å¥½çš„`MainHook`ä¸­å»ï¼Œç¼–è¯‘æ¨é€åˆ°æ‰‹æœºã€‚

åœ¨ç»ˆç«¯æ‰§è¡Œ`adb logcat "lbqaq:D *:S"`å¼€å¯logcatå¹¶è¿›è¡Œè¿‡æ»¤ã€‚


```text
â¯ adb logcat "lbqaq:D *:S"
--------- beginning of main
07-21 10:49:48.185  5050  5050 D lbqaq   : public void ceui.lisa.activities.Shaft.onCreate()
07-21 10:49:48.194  5050  5050 D lbqaq   : private void ceui.lisa.activities.Shaft.updateTheme()
07-21 10:49:48.216  5050  5050 D lbqaq   : public static android.content.Context ceui.lisa.activities.Shaft.getContext()
07-21 10:49:48.238  5050  5050 D lbqaq   : protected int ceui.lisa.activities.MainActivity.initLayout()
07-21 10:49:48.238  5050  5050 D lbqaq   : public boolean ceui.lisa.activities.MainActivity.hideStatusBar()
07-21 10:49:48.276  5050  5050 D lbqaq   : protected void ceui.lisa.activities.MainActivity.initView()
07-21 10:49:48.276  5050  5050 D lbqaq   : public static com.tencent.mmkv.MMKV ceui.lisa.activities.Shaft.getMMKV()
07-21 10:49:48.276  5050  5050 D lbqaq   : private void ceui.lisa.activities.MainActivity.initDrawerHeader()
07-21 10:49:48.278  5050  5050 D lbqaq   : public androidx.drawerlayout.widget.DrawerLayout ceui.lisa.activities.MainActivity.getDrawer()
07-21 10:49:48.279  5050  5050 D lbqaq   : protected void ceui.lisa.activities.MainActivity.initData()
07-21 10:49:48.279  5050  5050 D lbqaq   : private void ceui.lisa.activities.MainActivity.initFragment()
```



å¯ä»¥çœ‹åˆ°è¯¥ç¨‹åºçš„è°ƒç”¨æ–¹æ³•ã€‚è¿™é‡Œï¼Œæˆ‘ä»¬é€‰æ‹©é åçš„`ceui.lisa.activities.MainActivity.initFragment()`ä½œä¸ºæˆ‘ä»¬çš„Hookç›®æ ‡ã€‚

ä¸ºä»€ä¹ˆè¦é€‰æ‹©é åçš„æ–¹æ³•ä½œä¸ºæˆ‘ä»¬çš„Hookç›®æ ‡å‘¢ï¼Ÿ

è¿™æ˜¯ç”±äºå¦‚æœé€‰æ‹©è¾ƒå‰çš„æ–¹æ³•ï¼Œæœ‰äº›å˜é‡è¿˜æ²¡åˆå§‹åŒ–å®Œæˆï¼Œè¿™æ—¶è°ƒç”¨`finish()`å¯èƒ½ä¼šæŠ¥é”™ã€‚

### [#](https://lbqaq.top/p/init-xposed/#hook-activity) Hook activity

æˆ‘ä»¬ä½¿ç”¨æœ€åŸºç¡€çš„hookæ–¹å¼ï¼Œå³Xposedè‡ªå¸¦çš„`XposedHelpers.findAndHookMethod`ï¼Œä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š



```
private void hook(XC_LoadPackage.LoadPackageParam lpparam) {
    // å®ƒæœ‰ä¸¤ä¸ªé‡è½½ï¼ŒåŒºåˆ«æ˜¯ä¸€ä¸ªæ˜¯å¡«Classï¼Œä¸€ä¸ªæ˜¯å¡«ClassNameä»¥åŠClassLoader
    // ç¬¬ä¸€ç§ å¡«ClassName
    XC_MethodHook.Unhook unhook = XposedHelpers.findAndHookMethod("me.kyuubiran.xposedapp.MainActivity",    // className
            lpparam.classLoader,    // classLoader ä½¿ç”¨lpparam.classLoader
            "onCreate",             // è¦hookçš„æ–¹æ³•
            Bundle.class,           // è¦hookçš„æ–¹æ³•çš„å‚æ•°è¡¨ï¼Œå¦‚æœæœ‰å¤šä¸ªå°±ç”¨é€—å·éš”å¼€ 
            new XC_MethodHook() {   // æœ€åä¸€ä¸ªå¡«hookçš„å›è°ƒ
                @Override
                protected void beforeHookedMethod(MethodHookParam param) {} // Hookæ–¹æ³•æ‰§è¡Œå‰  
                @Override
                protected void afterHookedMethod(MethodHookParam param) {} // Hookæ–¹æ³•æ‰§è¡Œå
            });
    // å®ƒè¿”å›ä¸€ä¸ªunhook åœ¨ä½ ä¸éœ€è¦ç»§ç»­hookçš„æ—¶å€™å¯ä»¥è°ƒç”¨å®ƒæ¥å–æ¶ˆHook
    unhook.unhook();    // å–æ¶ˆç©ºçš„Hook 

    // ç¬¬äºŒç§æ–¹å¼ å¡«Class
    // é¦–å…ˆä½ å¾—åŠ è½½å®ƒçš„ç±» æˆ‘ä»¬ä½¿ç”¨XposedHelpers.findClasså³å¯ å‚æ•°æœ‰ä¸¤ä¸ª ä¸€ä¸ªæ˜¯ç±»å ä¸€ä¸ªæ˜¯ç±»åŠ è½½å™¨
    Class<?> clazz = XposedHelpers.findClass("me.kyuubiran.xposedapp.MainActivity", lpparam.classLoader);
    XposedHelpers.findAndHookMethod(clazz, "onCreate", Bundle.class, new XC_MethodHook() {
        @Override
        protected void afterHookedMethod(MethodHookParam param){
            // ç”±äºæˆ‘ä»¬éœ€è¦åœ¨Activityåˆ›å»ºä¹‹åå†å¼¹å‡ºToastï¼Œæ‰€ä»¥æˆ‘ä»¬Hookæ–¹æ³•æ‰§è¡Œä¹‹å
            Toast.makeText((Activity) param.thisObject, "æ¨¡å—åŠ è½½æˆåŠŸï¼", Toast.LENGTH_SHORT).show();
        }
    });
}

```

æ ¹æ®ä¸Šé¢çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥å†™å‡ºå¯¹åº”çš„æ–¹æ³•äº†ã€‚é‚£ä¹ˆï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•ç»“æŸè¿™ä¸ªç¨‹åºå‘¢ï¼Ÿåœ¨å‰é¢æˆ‘ä»¬ä»‹ç»äº†Activityçš„ç”Ÿå­˜å‘¨æœŸï¼Œé€šè¿‡æŸ¥è¯¢å¯çŸ¥Activityå­˜åœ¨ä¸€ä¸ªå…³é—­çš„æ–¹æ³•`finish()`ã€‚æ‰€ä»¥æˆ‘ä»¬åªè¦æ‰‹åŠ¨è°ƒç”¨å³å¯ï¼Œå…·ä½“çš„ä»£ç å¦‚ä¸‹ã€‚

```java
if (lpparam.packageName.equals("ceui.lisa.pixiv")){
    XposedHelpers.findAndHookMethod("ceui.lisa.activities.MainActivity", lpparam.classLoader, "initFragment", new XC_MethodHook() {
        @Override
        protected void afterHookedMethod(MethodHookParam param) throws Throwable {
            Toast.makeText((Activity) param.thisObject, "ä¸è®¸æ¶©æ¶©ï¼", Toast.LENGTH_SHORT).show();
            ((Activity) param.thisObject).finish();
        }
    });
}
```



åŒæ ·ï¼Œå¦å¤–ä¸¤ä¸ªåº”ç”¨ä¹Ÿå¯ä»¥é€šè¿‡è¿™ç§æ–¹å¼å®ç°


    XposedHelpers.findAndHookMethod("com.hippo.ehviewer.ui.MainActivity", lpparam.classLoader, "initUserImage", new XC_MethodHook() {
        @Override
        protected void afterHookedMethod(MethodHookParam param) throws Throwable {
            Toast.makeText((Activity) param.thisObject, "ä¸è®¸æ¶©æ¶©ï¼", Toast.LENGTH_SHORT).show();
            ((Activity) param.thisObject).finish();
        }
    });
}



```java
if(lpparam.packageName.equals("com.picacomic.fregata")){
    XposedHelpers.findAndHookMethod("com.picacomic.fregata.activities.SplashActivity", lpparam.classLoader, "onCreate", Bundle.class ,new XC_MethodHook() {
        @Override
        protected void afterHookedMethod(MethodHookParam param) throws Throwable {
            Toast.makeText((Activity) param.thisObject, "ä¸è®¸æ¶©æ¶©ï¼", Toast.LENGTH_SHORT).show();
            ((Activity) param.thisObject).finish();
        }
    });
}
```


è¿™é‡Œè¦æ³¨æ„ï¼Œä½¿ç”¨`findAndHookMethod`æ—¶è¦hookçš„æ–¹æ³•çš„å‚æ•°è¡¨ä¸€å®šè¦å¡«å¯¹ã€‚å¦‚æœæ²¡æœ‰å¡«å¯¹å°±ä¼šæŠ¥`java.lang.NoSuchMethodError`é”™è¯¯ã€‚æˆ‘ä¹‹å‰è¢«è¿™ä¸ªé—®é¢˜æŠ˜ç£¨äº†å¾ˆä¹…ğŸ˜­ï¼ˆä»”ç»†æƒ³æƒ³ä¹Ÿæ˜¯è¿™æ ·ï¼ŒJavaé‡Œæœ‰é‡è½½æœºåˆ¶ï¼Œå‚æ•°ä¸åŒå°±ä¸æ˜¯åŒä¸€ä¸ªæ–¹æ³•äº†ï¼‰

kotlinæ‰€å¯¹åº”çš„ä»£ç å¦‚ä¸‹ï¼š


```kotlin
if (lpparam.packageName == "com.xjs.ehviewer"){
    XposedHelpers.findAndHookMethod("com.hippo.ehviewer.ui.MainActivity", lpparam.classLoader, "initUserImage",object : XC_MethodHook() {
        override fun afterHookedMethod(param: MethodHookParam){
            Toast.makeText(param.thisObject as Activity,"ä¸è®¸æ¶©æ¶©ï¼",Toast.LENGTH_SHORT).show()
            (param.thisObject as Activity).finish()
        }
    })
}
        
```


### [#](https://lbqaq.top/p/init-xposed/#%e4%bf%ae%e6%94%b9%e5%86%85%e9%83%a8%e5%8f%82%e6%95%b0) ä¿®æ”¹å†…éƒ¨å‚æ•°

è™½ç„¶ä¸€è‚¡è„‘å…³é—­ç¨‹åºéå¸¸ç®€å•ï¼Œä½†å°æ˜ä¸ä¹æ„äº†ã€‚å¯¹äº`ceui.lisa.pixiv`æ¥è¯´ï¼Œåªæœ‰é•¿æŒ‰å¤´åƒæ‰ä¼šè§¦å‘ï¼Œç›´æ¥ä¸€åˆ€åˆ‡å®åœ¨æ˜¯å¤ªç²—æš´äº†ã€‚æ²¡é—®é¢˜ï¼Œç›´æ¥å®‰æ’ä¸Šã€‚

é¦–å…ˆæˆ‘ä»¬è¦å®šä½åˆ°è¿™ä¸ªåˆ‡æ¢çš„æ–¹æ³•ç©¶ç«Ÿåœ¨å“ªï¼Ÿä»”ç»†è§‚å¯Ÿï¼Œæ¯æ¬¡åˆ‡æ¢éƒ½ä¼šå¼¹å‡ºä¸€ä¸ªé¢œæ–‡å­—çš„Toastï¼Œæˆ‘ä»¬å°±ä»æ­¤å¤„åˆ‡å…¥ã€‚è¿™ä¸¤ä¸ªé¢œæ–‡å­—åˆ†åˆ«ä¸º`Ô…(â™¡ï¹ƒâ™¡Ô…)`å’Œ`Xï¹X`ã€‚

æˆ‘ä»¬ä½¿ç”¨jadx-guiåç¼–è¯‘ç¨‹åºï¼Œå…¨å±€æœç´¢ï¼Œç›´æ¥å°±æ‰¾åˆ°äº†æ‰€åœ¨ä½ç½®ã€‚

[![å…¨å±€æœç´¢](https://lbqaq.top/p/init-xposed/IMAGE/image-20230721141436862.png)](https://lbqaq.top/p/init-xposed/IMAGE/image-20230721141436862.png)
å…¨å±€æœç´¢

åŒå‡»æŸ¥çœ‹æ­¤å¤„çš„ä»£ç ï¼Œåèµ·æ¥äº†ï¼Œè¿™æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œæ ¹æ®ä¸Šé¢çš„æ–¹æ³•ï¼Œæˆ‘ä»¬æ²¡æœ‰è¿™ä¸ªå‡½æ•°åï¼Œè‡ªç„¶ä¹Ÿå°±æ— æ³•å¯¹å…¶è¿›è¡ŒHookã€‚

[![å…·ä½“ä»£ç ](https://lbqaq.top/p/init-xposed/IMAGE/image-20230721141535571.png)](https://lbqaq.top/p/init-xposed/IMAGE/image-20230721141535571.png)
å…·ä½“ä»£ç 

éš¾é“å°±è¦å¡åœ¨è¿™é‡Œäº†å—ï¼Ÿ~å¦‚æœçœŸæ˜¯è¿™æ ·æˆ‘å°±ä¸ä¼šå†™è¿™ç¯‡æ–‡ç« äº†~

ä»”ç»†åˆ†æè¿™æ®µä»£ç ï¼Œè¿™é‡Œå¯¹`this.userHead`è®¾ç½®äº†ä¸€ä¸ª`OnLongClickListener`ã€‚ä¸€ä¸ªæ§ä»¶åªèƒ½ç»‘å®šä¸€ä¸ªä¾¦å¬å™¨ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿›è¡Œä¸€ä¸ªæ›¿æ¢ï¼Œä¸å°±å®ç°å¯¹å…¶çš„Hookäº†å—ğŸ˜

ç›´æ¥Hook `initView`è¿™ä¸ªæ–¹æ³•ï¼š


```java
if (lpparam.packageName.equals("ceui.lisa.pixiv")){
    XposedHelpers.findAndHookMethod("ceui.lisa.activities.MainActivity", lpparam.classLoader, "initView", new XC_MethodHook() {
        @Override
        protected void afterHookedMethod(MethodHookParam param) throws Throwable {
            Field f = param.thisObject.getClass().getDeclaredField("userHead");
            f.setAccessible(true);
            ImageView v = (ImageView) f.get(param.thisObject);
//          v.setLongClickable(false);    //è®¾ç½®å…¶æ— æ³•å“åº”
            v.setOnLongClickListener(v1 -> {
                Toast.makeText((Activity) param.thisObject, "ä¸è®¸æ¶©æ¶©ï¼", Toast.LENGTH_SHORT).show();
                return true;
            });
        }
    });
}
```


æˆ‘ä»¬è¿™é‡Œä½¿ç”¨äº†Javaçš„åå°„æœºåˆ¶ï¼Œæ‹¿åˆ°äº†å®ƒå†…éƒ¨çš„å˜é‡`userHead`ï¼Œç„¶åé€šè¿‡`setAccessible`å°†å…¶è®¾ç½®ä¸ºå¯è®¿é—®ã€‚è¿™æ ·æˆ‘ä»¬å°±èƒ½å¯¹å…¶ç§æœ‰å˜é‡è¿›è¡Œä¿®æ”¹äº†ã€‚

æˆ‘ä»¬å¯ä»¥ç®€å•çš„å°†å…¶å¯ç‚¹å‡»å…³é—­ï¼Œä½†æ˜¯è¿™æ ·ä¸€ç‚¹ä¹Ÿä¸é…·ã€‚æˆ‘ç›´æ¥ä½¿ç”¨è‡ªå·±çš„å‡½æ•°å°†å…¶è¿›è¡Œæ›¿æ¢ï¼Œè¿™æ ·æ¯æ¬¡ç‚¹å‡»éƒ½ä¼šå‡ºç°ä¸€ä¸ª`Toast`ã€‚

kotlinçš„ä»£ç å¦‚ä¸‹ï¼š


```kotlin
if (lpparam.packageName == "ceui.lisa.pixiv"){
    XposedHelpers.findAndHookMethod("ceui.lisa.activities.MainActivity", lpparam.classLoader, "initView",object : XC_MethodHook() {
        override fun afterHookedMethod(param: MethodHookParam){
            val f = param.thisObject.javaClass.getDeclaredField("userHead")
            f.isAccessible = true
            val v = f[param.thisObject] as ImageView
            v.setOnLongClickListener{
                Toast.makeText(param.thisObject as Activity,"ä¸è®¸æ¶©æ¶©ï¼",Toast.LENGTH_SHORT).show()
                true
            }
    }
    })
}
```


è‡³æ­¤ï¼Œä¸€ä¸ªç®€å•çš„Xposedæ¨¡å—å°±å†™å¥½äº†ã€‚

## [#](https://lbqaq.top/p/init-xposed/#%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6%e8%af%bb%e5%8f%96) é…ç½®æ–‡ä»¶è¯»å–

ç°åœ¨çš„æ¨¡å—å¾€å¾€è¿˜ä¼šæ­é…ä¸€ä¸ªUIæ¥å®ç°é…ç½®æ–‡ä»¶çš„è®¾ç½®ï¼Œåœ¨å®‰å“å¼€å‘ä¸­ï¼Œå¸¸ç”¨`SharedPreferences`æ¥å®ç°é…ç½®çš„ä¿å­˜ã€‚éšç€googleçš„æ›´æ–°ï¼Œç°åœ¨çš„é…ç½®æ–‡ä»¶æ— æ³•è®¾ç½®`MODE_WORLD_READABLE`çš„æƒé™ï¼Œå³åªå…è®¸æœ¬åº”ç”¨è¯»å–ã€‚è™½ç„¶Xposedæœ¬èº«æä¾›äº†`XSharedPreferences`æ¥è¯»å–é…ç½®æ–‡ä»¶ï¼Œç„¶è€Œæ¨¡å—æ˜¯ä¾é™„äºå®¿ä¸»ç¨‹åºæ‰€æ‰§è¡Œçš„ï¼Œå®ƒçš„è®¿é—®æƒé™å’Œå®¿ä¸»ä¸€è‡´ï¼Œæ‰€ä»¥æ— æ³•è®¿é—®åˆ°æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶ã€‚[2024.09.15æ›´æ–°](https://lbqaq.top/p/init-xposed/#20240915)

å¥½åœ¨ç›®å‰å¸¸ç”¨çš„æ¡†æ¶LSPosedæä¾›äº†[New XSharedPreferences](https://github.com/LSPosed/LSPosed/wiki/New-XSharedPreferences)ï¼Œæˆ‘ä»¬åªéœ€è¦æŒ‡å®šxposedAPIçš„æœ€ä½ç‰ˆæœ¬â‰¥93å°±å¯ä»¥äº†ã€‚

åœ¨`AndroidManifest.xml`é‡Œå°†`xposedminversion`çš„å€¼æ”¹ä¸º`93`

å¯¹äºæ¨¡å—çš„Activityæ¥è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦æŒ‡å®šæƒé™ä¸º`Context.MODE_WORLD_READABLE`å³å¯

```kotlin
val sharedPreferences : SharedPreferences = getSharedPreferences("config", Context.MODE_WORLD_READABLE)
```


å¯¹äºhookçš„åº”ç”¨æ¥è¯´ï¼Œæˆ‘ä»¬ä½¿ç”¨åŸæ¥çš„`XSharedPreferences`å³å¯


```kotlin
val xsp = XSharedPreferences("top.lbqaq.nosese","config")
```


## [#](https://lbqaq.top/p/init-xposed/#%e7%bb%93%e8%af%ad) ç»“è¯­

å®Œæ•´çš„é¡¹ç›®ä»£ç å¯ä»¥åœ¨[Githubä»“åº“](https://github.com/luoboQAQ/nosese)ä¸­æŸ¥çœ‹ï¼Œé€šè¿‡è¿™æ¬¡çš„ç¼–å†™ï¼Œæˆ‘å‘ç°Xposedå®é™…ä¸Šè¿˜æ˜¯ä¸€ä¸ªå·¥å…·ï¼Œæƒ³è¦å®ç°å»å¹¿å‘Šç­‰åŠŸèƒ½ï¼Œéƒ½æ˜¯é€šè¿‡åç¼–è¯‘æ¥æ‰¾åˆ°çªç ´å£ï¼Œæœ‰äº†Hookçš„ç›®æ ‡åæ‰éœ€è¦Xposedã€‚

æ‰€ä»¥ï¼Œä¹‹åçš„å­¦ä¹ è¿˜æ˜¯è¦ä»¥å®‰å“é€†å‘ä¸ºä¸»ï¼Œåªæœ‰æ‰“å¥½åŸºæœ¬åŠŸï¼Œæ‰èƒ½å†™å‡ºä¼˜ç§€çš„ä»£ç ã€‚

## [#](https://lbqaq.top/p/init-xposed/#%e5%90%8e%e7%bb%ad%e6%9b%b4%e6%96%b0) åç»­æ›´æ–°

### [#](https://lbqaq.top/p/init-xposed/#20240915) 2024.09.15

å°†é¡¹ç›®ä½¿ç”¨äº†ç›®å‰æµè¡Œçš„Kotliné‡æ„äº†ä¸€æ³¢ï¼Œå¹¶æ·»åŠ äº†UIå’Œæ¨¡å—çš„é…ç½®è¯»å–çš„å†…å®¹

## [#](https://lbqaq.top/p/init-xposed/#%e5%8f%82%e8%80%83%e6%96%87%e7%8c%ae) å‚è€ƒæ–‡çŒ®

* [ã€Šå®‰å“é€†å‘è¿™æ¡£äº‹ã€‹ä¸ƒã€Sorryï¼Œä¼šHookçœŸçš„å¯ä»¥ä¸ºæ‰€æ¬²ä¸º-Xposedå¿«é€Ÿä¸Šæ‰‹(ä¸Š)æ¨¡å—ç¼–.. - å¾çˆ±ç ´è§£](https://www.52pojie.cn/thread-1740944-1-1.html)
* [Xposedæ¨¡å—å¼€å‘å…¥é—¨ä¿å§†çº§æ•™ç¨‹ - ç‹è¨€ç‹è¯­å’Œä»™è´çš„é­”æ³•å­¦ä¹ è®°å½•](https://blog.ketal.icu/cn/Xposed%E6%A8%A1%E5%9D%97%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8%E4%BF%9D%E5%A7%86%E7%BA%A7%E6%95%99%E7%A8%8B/)
* [ã€Šå®‰å“é€†å‘è¿™æ¡£äº‹ã€‹å››ã€æ­å–œä½ è·å¾—å¹¿å‘Š&å¼¹çª—é™é»˜å¡ - å¾çˆ±ç ´è§£](https://www.52pojie.cn/thread-1706691-1-1.html)
* [ã€Šå®‰å“é€†å‘è¿™æ¡£äº‹ã€‹å…«ã€Sorryï¼Œä¼šHookçœŸçš„å¯ä»¥ä¸ºæ‰€æ¬²ä¸º-Xposedå¿«é€Ÿä¸Šæ‰‹(ä¸‹)æ¨¡å—ç¼–.. - å¾çˆ±ç ´è§£](https://www.52pojie.cn/thread-1748081-1-1.html)

[æ•™ç¨‹](https://lbqaq.top/tags/%E6%95%99%E7%A8%8B/)[Xposed](https://lbqaq.top/tags/xposed/)[å®‰å“](https://lbqaq.top/tags/%E5%AE%89%E5%8D%93/)

Licensed under CC BY-NC-SA 4.0

æœ€åæ›´æ–°äº 2023-09-15 15:52:44
